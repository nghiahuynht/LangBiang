#pragma checksum "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "4ad4fbd1b414a10abdaff109260608ff5428b8b6"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_TicketOrder_SaleScreen), @"mvc.1.0.view", @"/Views/TicketOrder/SaleScreen.cshtml")]
[assembly:global::Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorViewAttribute(@"/Views/TicketOrder/SaleScreen.cshtml", typeof(AspNetCore.Views_TicketOrder_SaleScreen))]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#line 8 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
using DAL.Models.Customer;

#line default
#line hidden
#line 9 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
using DAL.Models.Ticket;

#line default
#line hidden
#line 10 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
using DAL.Entities;

#line default
#line hidden
#line 11 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
using DAL.Models;

#line default
#line hidden
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"4ad4fbd1b414a10abdaff109260608ff5428b8b6", @"/Views/TicketOrder/SaleScreen.cshtml")]
    public class Views_TicketOrder_SaleScreen : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            BeginContext(0, 2, true);
            WriteLiteral("\r\n");
            EndContext();
#line 2 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
  
    ViewData["Title"] = "Bán vé thăm quan";
    Layout = "~/Views/Shared/_Layout.cshtml";

#line default
#line hidden
            BeginContext(101, 4, true);
            WriteLiteral("\r\n\r\n");
            EndContext();
            DefineSection("styles", async() => {
                BeginContext(215, 1058, true);
                WriteLiteral(@"
    <link rel=""stylesheet"" href=""https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css"">

    <style>
       

        .btn-num {
            width: 100%;
            padding: 5px 10px;
            font-size: 16pt !important;
            margin: 3px;
            text-align: center;
        }

            .btn-num:hover {
                background: #3c8dbc !important;
                cursor: pointer;
            }

        .ticket-selected {
            background: #0094ff;
            color: #fff;
        }

        .filter-option-inner-inner {
            font-weight: bold;
            color: #333333;
        }


        /*Ticket item list*/
        #div-ticket {
            border:1px solid #f4f4f4;
        }

        .ticket-item {
            color:#333;
        }

            .ticket-item:hover {
                background: #DDF000;
            }

        .ticket-item-selected {
            background: #90F5E7;
        }

");
                WriteLiteral("        \r\n        \r\n    </style>\r\n");
                EndContext();
            }
            );
            BeginContext(1276, 598, true);
            WriteLiteral(@"<section class=""content-header"">
    <div class=""container-fluid"">
        <div class=""row mb-2"">
            <div class=""col-sm-6"">
                <h1><span id=""span-price-policy-available""></span>&nbsp; BÁN VÉ </h1>
            </div>
            <div class=""col-sm-6"">
                <div class=""row"">
                    <div class=""col-sm-4"">
                        <div class=""col-sm-12""><label class=""col-form-label"">Loại khách hàng</label></div>
                        <div class=""col-sm-12"">
                            <select class=""form-control"" id=""ddl-customer-type"">
");
            EndContext();
#line 75 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                  
                                    var lstCustType = (List<CustomerType>)ViewBag.ListCustType;

                                    foreach (var item in lstCustType)
                                    {
                                        string selected = item.Code == "Khach_Le" ? "selected='selected'" : string.Empty;

#line default
#line hidden
            BeginContext(2242, 47, true);
            WriteLiteral("                                        <option");
            EndContext();
            BeginWriteAttribute("value", " value=\"", 2289, "\"", 2309, 1);
#line 81 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
WriteAttributeValue("", 2297, item.Code, 2297, 12, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(2310, 1, true);
            WriteLiteral(" ");
            EndContext();
            BeginContext(2313, 8, false);
#line 81 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                                                 Write(selected);

#line default
#line hidden
            EndContext();
            BeginContext(2322, 1, true);
            WriteLiteral(">");
            EndContext();
            BeginContext(2324, 9, false);
#line 81 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                                                            Write(item.Name);

#line default
#line hidden
            EndContext();
            BeginContext(2333, 11, true);
            WriteLiteral("</option>\r\n");
            EndContext();
#line 82 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                    }
                                

#line default
#line hidden
            BeginContext(2418, 1520, true);
            WriteLiteral(@"                            </select>

                        </div>
                    </div>

                    <div class=""col-sm-4"">
                        <div class=""col-sm-12""><label class=""col-form-label"">Khách hàng</label></div>
                        <div class=""col-sm-12"">
                            <select class=""form-control"" id=""ddl-customer"" data-style=""btn-info"" data-live-search=""true""></select>

                        </div>
                    </div>
                    <div class=""col-sm-4"">
                        <div class=""col-sm-12""><label class=""col-form-label"">Đối tượng</label></div>
                        <div class=""col-sm-12"">
                            <select id=""ddl-objType"" class=""form-control"" data-style=""btn-info"">
                                <option value=""NguoiLon"">Người lớn</option>
                                <option value=""TreEm"">Trẻ em</option>
                            </select>
                        </div>
                   ");
            WriteLiteral(@" </div>
                </div>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>
<section class=""content"">
    <div class=""row"">
        <div class=""col-sm-6"">
            <input type=""hidden"" id=""hid_TicketCode"" value="""" />
            <input type=""hidden"" id=""hid_TicketPrice"" value="""" />

            <div id=""div-ticket"">
                <div class=""row"">
                    <table class=""table table-bordered bg-white"" id=""table-ticket-sale"">
");
            EndContext();
#line 119 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                          
                            var lstGroupTicket = (List<TicketGroupModel>)ViewBag.GroupTicketList;
                            var lstTicket = (List<Ticket>)ViewBag.TicketList;
                            foreach (var itemGroup in lstGroupTicket)
                            {
                                var lstTicketSub = lstTicket.Where(x => x.TicketGroup == itemGroup.GroupCode);
                                if (lstTicketSub.Any())
                                {

#line default
#line hidden
            BeginContext(4450, 128, true);
            WriteLiteral("                                    <tr>\r\n                                        <th colspan=\"2\"><span class=\"text-blue\">::::: ");
            EndContext();
            BeginContext(4580, 19, false);
#line 128 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                                                                  Write(itemGroup.GroupName);

#line default
#line hidden
            EndContext();
            BeginContext(4600, 63, true);
            WriteLiteral(" :::::</span></th>\r\n                                    </tr>\r\n");
            EndContext();
#line 130 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                    foreach (var itemTicket in lstTicket.Where(x => x.TicketGroup == itemGroup.GroupCode))
                                    {

#line default
#line hidden
            BeginContext(4826, 43, true);
            WriteLiteral("                                        <tr");
            EndContext();
            BeginWriteAttribute("id", " id=\"", 4869, "\"", 4899, 2);
            WriteAttributeValue("", 4874, "ticket-", 4874, 7, true);
#line 132 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
WriteAttributeValue("", 4881, itemTicket.Code, 4881, 18, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(4900, 20, true);
            WriteLiteral(" class=\"ticket-item\"");
            EndContext();
            BeginWriteAttribute("onclick", " onclick=\"", 4920, "\"", 4989, 5);
            WriteAttributeValue("", 4930, "mouseSelectTicket(\'", 4930, 19, true);
#line 132 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
WriteAttributeValue("", 4949, itemTicket.Code, 4949, 18, false);

#line default
#line hidden
            WriteAttributeValue("", 4967, "\',", 4967, 2, true);
#line 132 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
WriteAttributeValue("", 4969, itemTicket.Price, 4969, 19, false);

#line default
#line hidden
            WriteAttributeValue("", 4988, ")", 4988, 1, true);
            EndWriteAttribute();
            BeginContext(4990, 96, true);
            WriteLiteral(">\r\n                                            <td width=\"25%\"><i class=\"fa fa-tag\"></i> &nbsp; ");
            EndContext();
            BeginContext(5088, 15, false);
#line 133 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                                                                         Write(itemTicket.Code);

#line default
#line hidden
            EndContext();
            BeginContext(5104, 67, true);
            WriteLiteral("</td>\r\n                                            <td width=\"75%\">");
            EndContext();
            BeginContext(5173, 22, false);
#line 134 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                                        Write(itemTicket.Description);

#line default
#line hidden
            EndContext();
            BeginContext(5196, 56, true);
            WriteLiteral("</td>\r\n\r\n                                        </tr>\r\n");
            EndContext();
#line 137 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                    }


                                }





                            }
                        

#line default
#line hidden
            BeginContext(5398, 5564, true);
            WriteLiteral(@"                    </table>
                    
                </div>
               

            </div>



        </div>
        <div class=""col-sm-6"">
            <div class=""card"">
                <div class=""card-header"">
                    <div class=""row"">
                        <div class=""col-sm-6"">
                            
                        </div>
                        <div class=""col-sm-6"">
                            
                        </div>

                    </div>
                    <div class=""row"">

                        <div class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Đơn giá</label>
                            <div class=""col-md-12"">
                                <input type=""number"" class=""form-control"" style=""font-size:16pt;font-weight:bold;"" onblur=""calculaTotal()"" id=""txt-price-by-policy"" />
                            </div>
                        </div>
                        <div");
            WriteLiteral(@" class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Số lượng</label>
                            <div class=""col-md-12"">
                                <input type=""number"" class=""form-control"" style=""font-size:18pt;font-weight:bold;"" onblur=""calculaTotal()"" id=""txt-quanti"" value=""1"" />
                            </div>
                        </div>
                        <div class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Thành tiền</label>
                            <div class=""col-md-12"">
                                <h5 id=""span-total"" style=""font-size:18pt;color:#0094ff;"">0</h5>
                            </div>
                        </div>
                    </div>
                    <div class=""row"">


                        <div class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Khuyến mãi (%)</label>
                            <div class=""col-md-12"">
         ");
            WriteLiteral(@"                       <input type=""number"" class=""form-control"" style=""font-size:18pt;font-weight:bold;"" onblur=""calculaTotal()"" id=""txt-km-percen"" value=""0"" />
                            </div>
                        </div>
                        <div class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Tiền khuyến mãi</label>
                            <div class=""col-md-12"">
                                <h5 id=""span-tien-khuyemmai"" style=""font-size:18pt;color:#b200ff;"">0</h5>
                            </div>
                        </div>
                        <div class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Tổng thanh toán</label>
                            <div class=""col-md-12"">
                                <h5 id=""span-total-after-khuyenmai"" style=""font-size:18pt;color:#ff0000;"">0</h5>
                            </div>
                        </div>
                    </div>
                    ");
            WriteLiteral(@"<div class=""row"">
                       
                        
                    </div>
   
                    <div class=""row"">
                        <div class=""col-sm-4"">
                            <label class=""col-md-12 col-form-label"">Khách đưa</label>
                            <div class=""col-md-12"">
                                <input type=""number"" class=""form-control"" style=""font-size:16pt;font-weight:bold;"" onblur=""calculaTotal()"" id=""txt-cus-payamount"" />
                            </div>
                        </div>
                        <div class=""col-sm-8"">
                            <label class=""col-md-12 col-form-label"">Tiền thối</label>
                            <div class=""col-md-12"">
                                <h5 id=""span-tien-thoi"" style=""font-size:18pt;"">0</h5>
                            </div>
                        </div>
                    </div>


                    <div class=""row"">
                        <div class=""col-sm-6""");
            WriteLiteral(@">
                            <label class=""col-md-12 col-form-label"">Loại đơn</label>
                            <div class=""row"">
                                <div class=""col-md-6"">
                                    <input type=""radio"" style=""width:15px;height:15px;"" value=""false"" name=""radioisfree"" checked=""checked"" />&nbsp;Bình thường
                                </div>
                                <div class=""col-md-6"">
                                    <input type=""radio"" style=""width:15px;height:15px;"" value=""true"" name=""radioisfree"" />&nbsp;Miễn phí
                                </div>
                            </div>

                        </div>
                        <div class=""col-sm-6"">
                            <label class=""col-md-12 col-form-label"">Kiểu in</label>
                            <div class=""col-md-12"">
                                <select id=""ddl-printtypes"" class=""form-control"" data-style=""btn-info"">
                                    <");
            WriteLiteral(@"option value=""InLe"">In lẻ</option>
                                    <option value=""InGop"">In gộp</option>
                                    <option value=""InQRCode"">In QR Code</option>
                                </select>
                            </div>
                        </div>




                    </div>
                </div>
                <div class=""card-body"">
                    <div class=""row"">
");
            EndContext();
#line 265 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                          
                            for (int stt = 1; stt <= 9; stt++)
                            {

#line default
#line hidden
            BeginContext(11085, 120, true);
            WriteLiteral("                                <div class=\"col-sm-2\">\r\n                                    <div class=\"btn-num bg-info\"");
            EndContext();
            BeginWriteAttribute("onclick", " onclick=\"", 11205, "\"", 11231, 3);
            WriteAttributeValue("", 11215, "clickNum(", 11215, 9, true);
#line 269 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
WriteAttributeValue("", 11224, stt, 11224, 6, false);

#line default
#line hidden
            WriteAttributeValue("", 11230, ")", 11230, 1, true);
            EndWriteAttribute();
            BeginContext(11232, 1, true);
            WriteLiteral(">");
            EndContext();
            BeginContext(11235, 3, false);
#line 269 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                                                                                        Write(stt);

#line default
#line hidden
            EndContext();
            BeginContext(11239, 48, true);
            WriteLiteral("</div>\r\n                                </div>\r\n");
            EndContext();
#line 271 "D:\Projects\OnGit\LangBianSytem\Langbiang_Web\WebApp\Views\TicketOrder\SaleScreen.cshtml"
                            }

#line default
#line hidden
            BeginContext(11318, 376, true);
            WriteLiteral(@"                            <div class=""col-sm-2"">
                                <div class=""btn-num bg-info"" onclick=""clickNum(0)"">0</div>
                            </div>
                            <div class=""col-sm-4"">
                                <div class=""btn-num bg-warning"" onclick=""clearQuanti()"">Xóa nhập lại</div>
                            </div>
");
            EndContext();
            BeginContext(11721, 1289, true);
            WriteLiteral(@"                    </div>
                    <div class=""row"">
                        <div class=""col-sm-12"">
                            <div class=""btn-num bg-success"" onclick=""SaleOrderByGate()"">OK BÁN VÉ</div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class=""clearfix""></div>
        <br /> <br />

        <div class=""col-sm-12"" style=""margin-top:10px;"">
            <div class=""card"">
                <div class=""card-header card-outline card-primary with-border"">
                    <h3 class=""card-title text-red"">Lưu ý: trường hợp lỗi bán vé và cách khắc phục</h3>

                </div>
                <div class=""card-body"">
                    <span><strong>1. Lỗi thông báo bán vé không thành công: </strong>Kiểm tra internet, hoặc đăng xuất ra và đăng nhập lại</span><br />
                    <span><strong>2. Không in được vé: </strong>Kiểm tra máy in xem có kẹt giấy hoặc hết giấy không? sau đ");
            WriteLiteral(@"ó vào lịch sửa bán vé in lại</span><br />
                    <span><strong>3. Không truy cập được phần mềm: </strong>Kiểm tra internet và liên hệ GAMAN hỗ trợ</span>
                </div>

            </div>
        </div>


    </div>



</section>
");
            EndContext();
            DefineSection("scripts", async() => {
                BeginContext(13027, 12064, true);
                WriteLiteral(@"

    <script src=""https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js""></script>
    <script src=""https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js""></script>


    <script>
        var arrPricePolicy = [];
        $(document).ready(function () {

            GetAllPricePolicy();
            GetCustomerByType();
            $(""#ddl-customer-type"").change(function () {
                GetCustomerByType();
                let priceSale = GetPriceForSale();
                $(""#txt-price-by-policy"").val(priceSale);
                calculaTotal();
            });

            $(""#ddl-objType"").change(function () {
                let priceSale = GetPriceForSale();
                $(""#txt-price-by-policy"").val(priceSale);
                calculaTotal();
            });

            


        });


        function GetAllPricePolicy() {
            $.ajax({
                type: ""Get"",
                contentType: 'applicat");
                WriteLiteral(@"ion/json; charset=utf-8',
                url: ""/PricePolicy/GetAllPricePolicy"",
                success: function (res) {
                    debugger;
                    arrPricePolicy = res;
                    if (arrPricePolicy != null && arrPricePolicy.length > 0) {
                        $(""#span-price-policy-available"").addClass(""fa fa-star"");
                    }
                }
            });
        }


       

        function mouseSelectTicket(ticketCode, price) {
            
            if (!$(""#ticket-"" + ticketCode).hasClass(""ticket-item-selected""))
            {
                $("".ticket-item"").removeClass(""ticket-item-selected"");
                $(""#ticket-"" + ticketCode).addClass(""ticket-item-selected"");
                $(""#hid_TicketCode"").val(ticketCode);
                $(""#hid_TicketPrice"").val(price);

                let priceSale = GetPriceForSale();
                $(""#txt-price-by-policy"").val(priceSale);
                calculaTotal();
         ");
                WriteLiteral(@"   };


        }
        function calculaTotal()
        {
            /* tổng trước khuyến mãi */
            let quanti = ($(""#txt-quanti"").val() == """" || $(""#txt-quanti"").val() == null) ? 0 : parseInt($(""#txt-quanti"").val());
            let price = ($(""#txt-price-by-policy"").val() == """" || $(""#txt-price-by-policy"") == null) ? 0 : parseFloat($(""#txt-price-by-policy"").val());
            let totalFirst = quanti * price;
            $(""#span-total"").html(RenderTotal(totalFirst));

            /* khuyến mãi */
            let discountPercent = ($(""#txt-km-percen"").val() == """" || $(""#txt-km-percen"").val() == null) ? 0 : parseFloat($(""#txt-km-percen"").val());
            let tienkhuyenmai = Math.round((totalFirst * (discountPercent / 100)));
            let tienkhuyenmailamtron = LamTronKhuyenMai(tienkhuyenmai);
            $(""#span-tien-khuyemmai"").html(RenderTotal(tienkhuyenmailamtron));

            /* tổng sau khuyến mãi*/
            let totalLast = totalFirst - tienkhuyenmailamtron;
 ");
                WriteLiteral(@"           $(""#span-total-after-khuyenmai"").html(RenderTotal(totalLast));

            /* tiền thối*/
            let khachdua = ($(""#txt-cus-payamount"").val() == """" || $(""#txt-cus-payamount"").val() == null) ? 0 : parseFloat($(""#txt-cus-payamount"").val());
            let tienthoi = khachdua - totalLast;
            $(""#span-tien-thoi"").html(RenderTotal(tienthoi));
        }

        function LamTronKhuyenMai(tienkm)
        {
            let arrKM = RenderTotal(tienkm).split("","");
            if (arrKM.length > 0)
            {
                let hantram = parseFloat(arrKM[arrKM.length - 1]);
                if (hantram >= 500) {
                    return tienkm + (1000 - hantram);
                }
                else {
                    return tienkm - parseFloat(hantram);
                }
            }
            
        }
        function clickNum(num) {

            let currentNum = $(""#txt-quanti"").val();
            let newNum = currentNum + """" + num;

            $");
                WriteLiteral(@"(""#txt-quanti"").val(newNum);
            calculaTotal();
        }
        function clearQuanti() {

            $(""#txt-quanti"").val(null);
            calculaTotal();
        }




        function GetCustomerByType() {
            let customerType = $(""#ddl-customer-type"").val();
            $.ajax({
                type: ""Get"",
                contentType: 'application/json; charset=utf-8',
                url: ""/Customer/GetListCustomerByCustType?customerType="" + customerType,
                success: function (res) {
                    let optionCus = """";
                    $.each(res, function (key, value) {
   
                        optionCus = optionCus + ""<option value='"" + value.customerCode+""'>""+value.customerName+""</option>"";
                    });
                    $(""#ddl-customer"").html(optionCus);

                }
            });
        }


        function GetPriceForSale() {
            let ticketCode = $(""#hid_TicketCode"").val();
            let c");
                WriteLiteral(@"ustomerType = $(""#ddl-customer-type"").val();
            let objType = $(""#ddl-objType"").val();

            let policyOject = arrPricePolicy.filter(x => x.ticketCode == ticketCode
                && x.customerType == customerType
                && x.customerForm == objType)[0];

            if (policyOject != null) {
                return policyOject.price;
            } else {
                return 0;
            }


        }

        function SaleOrderByGate()
        {

            


            if ($(""#txt-quanti"").val() == """" || $(""#txt-quanti"").val() == null) {
                bootbox.alert(AlertFail(""Bạn chưa chọn số lượng""));
            }
            else if ($(""#txt-km-percen"").val() == """" || $(""#txt-km-percen"").val() == null)
            {
                bootbox.alert(AlertFail(""Bạn chưa nhập khuyến mãi, không có thì nhập khuyến mãi = 0""));
            }
            else if ($(""#txt-cus-payamount"").val() == """" || $(""#txt-cus-payamount"").val() == null) {
        ");
                WriteLiteral(@"        bootbox.alert(AlertFail(""Bạn chưa nhập tiền khách đưa""));
            }
            else if ($(""#hid_TicketCode"").val() == """" || $(""#hid_TicketCode"").val() == null) {
                bootbox.alert(AlertFail(""Bạn chưa chọn vé bán""));
            }
            else {

                let quanti = ($(""#txt-quanti"").val() == """" || $(""#txt-quanti"").val() == null) ? 0 : parseInt($(""#txt-quanti"").val());
                let doituong = $(""#ddl-objType"").val();
                let isFree = $('input[name=""radioisfree""]:checked').val();
                let price = GetPriceForSale();

                if (price == 0) // nếu price ko nằm trong policy
                {
                    price = parseFloat($(""#txt-price-by-policy"").val());
                }

                let discountPercent = ($(""#txt-km-percen"").val() == """" || $(""#txt-km-percen"").val() == null) ? 0 : parseFloat($(""#txt-km-percen"").val());
                let discountValue = $(""#span-tien-khuyemmai"").text();
                le");
                WriteLiteral(@"t khachdua = ($(""#txt-cus-payamount"").val() == """" || $(""#txt-cus-payamount"").val() == null) ? 0 : parseFloat($(""#txt-cus-payamount"").val());
                debugger;
                let customerName = $(""#ddl-customer option:selected"").text();
                var modelData = {
                    TicketCode: $(""#hid_TicketCode"").val(),
                    CustomerCode: $(""#ddl-customer"").val(),
                    CustomerName: customerName,
                    CustomerType: $(""#ddl-customer-type"").val(),
                    ObjType: doituong,
                    PrintType: $(""#ddl-printtypes"").val(),
                    Quanti: quanti,
                    Price: price,
                    IsFree: isFree,
                    GateName: ""LBL"",
                    DiscountPercent: discountPercent,
                    DiscountValue: discountValue,
                    TienKhachDua: khachdua,
                }

                $.ajax({
                    type: ""POST"",
                    cont");
                WriteLiteral(@"entType: 'application/json; charset=utf-8',
                    url: ""/TicketOrder/SaleOrderAction"",
                    dataType: 'json',
                    data: JSON.stringify(modelData),
                    beforeSend: function () {
                        ShowWaiting();
                    },
                    success: function (res) {
                        HideWaiting();
                        debugger;
                        if (res.lstSubCode.length > 0)
                        {

                            bootbox.alert(AlertSuccess(""Bán vé thành công, chuẩn bị in vé""), function () {
                                let printOptionVal = $(""#ddl-printtypes"").val();
                                PrintOrder(printOptionVal, res.orderId, res.lstSubCode);
                                ResetSale();
                            });

                        } else {
                            bootbox.alert(AlertFail(""Bán vé không thành công, vui lòng đăng xuất và đăng nhập lại"")");
                WriteLiteral(@");
                        }

                    }
                });
            }





        }


        function PrintOrder(printOption,orderId ,lstTicketSuccess) {
            debugger;
            if (printOption == ""InLe"") {
                $.each(lstTicketSuccess, function (index, value) {
                    printPdf(""https://langbiang-land.gamanjsc.com/ticketorder/GetPDFForPrint?subId="" + value.subId);
                    //printPdf(""http://localhost:44377/ticketorder/GetPDFForPrint?subId="" + value.subId);
                });
            } else if (printOption == ""InGop"") {
                let firstRowId = lstTicketSuccess[0].subId;
                printPdf(""https://langbiang-land.gamanjsc.com/ticketorder/GetPDFForPrint?subId="" + firstRowId);
                //printPdf(""http://localhost:44377/ticketorder/GetPDFForPrint?subId="" + firstRowId);
            } else if (printOption == ""InQRCode"") {
                window.open('http://localhost:44377/ticketorder/PrintQRview?ord");
                WriteLiteral(@"erId=' + orderId, '_blank');
            }
        }
        


        function selectTicketItem(ticketCode, price, obj) {

            debugger;
            $(""#hid_GateCode"").val(null);
            $(""#hid_GatePrice"").val(null);

            $(""#hid_GateCode"").val(ticketCode);
            $(""#hid_GatePrice"").val(price);

            $(""#span-ticket-selected"").html("""");
            $(""#span-ticket-selected"").html(ticketCode);

            $("".ticket-item"").removeClass(""ticket-item-selected"");
            $(obj).addClass(""ticket-item-selected"");

            calculaTotal();





        }

        function printPdf(url) {
            var iframe = document.createElement('iframe');
            // iframe.id = 'pdfIframe'
            iframe.className = 'pdfIframe'
            document.body.appendChild(iframe);
            iframe.style.display = 'none';
            iframe.onload = function () {
                setTimeout(function () {
                    iframe.focus();
     ");
                WriteLiteral(@"               iframe.contentWindow.print();
                    URL.revokeObjectURL(url)
                    // document.body.removeChild(iframe)
                }, 1);
            };
            iframe.src = url;
            // URL.revokeObjectURL(url)
        }

        function ResetSale() {
            $("".ticket-item"").removeClass(""ticket-item-selected"");
            $(""#txt-quanti"").val(1);
            $(""#hid_TicketCode"").val(null);
            $(""#txt-price-by-policy"").val(null);
            calculaTotal();
        }
        function RenderTotal(data) {
            var res = """";
            if (data !== undefined) {
                res = data.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,');
            }
            return res;
        }
    </script>
");
                EndContext();
            }
            );
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
